\section{A not so short history of R}

  \subsection{A not so short history of R}
  
% Table generated by Excel2LaTeX from sheet 'Feuil1'
\begin{table}[htbp]
  \centering
  \scalebox{0.6}{
    \begin{tabular}{crl}
    \toprule
    \textbf{version} & \multicolumn{1}{c}{\textbf{Date}} & \multicolumn{1}{c}{\textbf{Description}} \\
    \midrule
    \textbf{0.49} & 1997 & La création du Comprehensive R Archive project. Les plus vieilles sources disponibles. \\
    \textbf{0.60} & 1997 & R devient officiellement une partie du projet GNU.  \\
    \textbf{0.65.1} & 1999 & Création des fonctions de chargement et d'installation des paquets \\
    \textbf{1.0} & 2000 & Création des fonctions de chargement et d'installation des paquets \\
    \textbf{3.0} & 2013 & Support pour les entiers $2^31$ et plus sur les systèmes 64 bits. \\
    \bottomrule
    \end{tabular}}%
  \label{tab:addlabel}%
\end{table}%




  \subsection{GNU et adopté par la communauté}
  
  Le langage R, initialement, suit en fait les spécifications d'un langage d'un logiciel 
  propriétaire $S+$. Le langage S décrit par Chambers \& al. est le langage de ce logicel.
  
  En référence, vous pourrez entendre parler de \emph{White book}, \emph{Yellow book}, \dots
  Ce sont des ouvrages de référence~: ils donnent les spécificités de S et plus
  tard de R.
  

  
  Devenu projet GNU, son portage sur Mac OS X en 2001 et la flexibilité du langage
  S permet à R de devenir une référence pour les statisticiens assez rapidement.
  
  Mais deux élements sont déterminants dans son avenir~:
  \begin{itemize}
    \item c'est un langage lent
    \item les paquets 
  \end{itemize}
  

  \subsection{Les tâlons d'Achille}
  
  R a longtemps, jusqu'en 2013, été limité par le volume des données qu'on pouvait
  stocker en mémoire.
  
  En 2013, ce frein a été levé avec un portage en 64 bits. Toutefois R reste limité
  par le fait qu'il travaille d'abord en mémoire vive et n'a pas été conçu comme
  d'autres logiciels pour ne stocker que le minimum en mémoire.
  
  Ainsi on peut être limité par la RAM quand on travaille sur R. C'est dans ces limites
  que s'insèrent les versions propriétaires de R qui offre des fonctionnalités
  spécifiques notamment pour les gros volumes de donnés et la parallélisation.
  

  
  Toutefois contrairement à d'autres logiciels, les versions propriétaires
  restent minoritaires car leurs spécificités ne sont pas si intéressantes.
  
  Mais c'est difficile à quantifier. 
  
  La version open source et libre R fait déjà tellement\dots
  

  \subsection{Les interfaces utilisateurs avec R}
  
  Les façons de faire du R~:
  \begin{itemize}
    \item en ligne de commande
    \item éditeur + copier/coller
    \item dans Emacs
    \item RStudio
    \item RStudio Server (dans un navigateur)
  \end{itemize}


  \subsection{Les paquets}
  
  Aujourd'hui nous sommes passés de 12 paquets à l'origine à près de 8300\dots
  
  Ces paquets sont souvent écrits par les auteurs des nouvelles méthodes 
  statistiques ce qui est garant de leur qualité. Ils sont souvent modifiés
  par la communauté pour plus de fonctionnalités et performances.
  
  Beaucoup d'entre eux sont hébergés sur Github et des outils permettent
  d'installer les paquets directement depuis Github pour les versions instables
  ou stables.
  
  C'est devenu une forêt dans laquelle il est facile de se perdre. Tout est 
  déjà écrit en R, le plus dur c'est de le trouver ;)
  

  \subsection{Les vues}
  
  Les paquets les plus importants et les plus intéressants sont
  répertoriés dans les vues, des ensembles de paquets maintenus par des 
  spécialistes du domaine. Il y a des vues pour~:
  \begin{itemize}
    \item le \emph{Clustering}
    \item le \emph{Machine Learning}
    \item l'expérimentation
    \item \dots
  \end{itemize}
  
  Un paquet \emph{ctv} permet d'installer et de mettre à jour les paquets d'une 
  vue en particulier. Pratique.
  

  \subsection{BioconductoR}
  
  En parallèle de du R, on trouve BioconductoR. C'est R toujours mais avec des
  dépôts de paquets séparés. 
  
  Dedans on trouve les outils de tous les jours pour les biologistes moléculaires,
  l'analyse phylogénétique, \dots

  Une partie importante des recrutement pour des gens compétents en R est dans la
  biologie et notamment la biologie moderne~: séquençage, analyse des séquences, 
  protéomique \dots Cette année 5 postes ont été proposés à l'institut Pasteur.
  

\section{La pratique}

  \subsection{RStudio}

  RStudio est un logiciel libre permettant de travailler plus facilement 
  avec R. 
  
  Au cours de ces dernières années, il s'est imposé comme une GUI quasi
  incontournable à R.
  

\section{Un peu de R\dots}

  \subsection{Principe}
  
  C'est un langage de programmation interprété. 
  
  Le stockage se fait en RAM.
  
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlkwb{<-} \hlnum{3} \hlopt{+} \hlnum{4}
\hlstd{> }\hlstd{a}
\end{alltt}
\begin{verbatim}
## [1] 7
\end{verbatim}
\end{kframe}
\end{knitrout}



  Vous remarquerez qu'un numéro apparait à gauche\dots C'est le numéro de l'
  élement dans le vecteur.
  
  C'est parce que dans R pratiquement tout est vecteur~:

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlkwb{<-} \hlkwd{rnorm}\hlstd{(}\hlnum{10}\hlstd{)}
\hlstd{> }\hlstd{a}
\end{alltt}
\begin{verbatim}
##  [1] -1.3725905  0.8814864  0.3821462
##  [4]  3.7392059 -0.8397317 -0.9899751
##  [7] -0.8071744  0.2860360  0.4523745
## [10]  0.7768804
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{class}\hlstd{(a)}
\end{alltt}
\begin{verbatim}
## [1] "numeric"
\end{verbatim}
\end{kframe}
\end{knitrout}



  Il existe plusieurs types de base pour les variables~:
  
  \begin{itemize}
    \item les \emph{numeric} pour stocker les nombres à virgules (ou flottants)
    \item les entiers, \emph{integer}
    \item les booléens, \emph{logical}
    \item les variables caractères, \emph{character}
    \item \dots
  \end{itemize}
  


  Il existe des structures de données plus complexes. Mais ce sont ces types
  de base qui n'existent que sous la forme de vecteurs.
  
  Toute variable créeest au minimum un vecteur de longueur 1.
  


  \subsection{Absence de typage fixe}

  Une variable est versatile, elle n'est pas définie comme dans d'autres langages.
  
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlkwb{<-} \hlnum{5}
\hlstd{> }\hlstd{a}
\end{alltt}
\begin{verbatim}
## [1] 5
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlkwb{<-} \hlstr{"Hello World !"}
\hlstd{> }\hlstd{a}
\end{alltt}
\begin{verbatim}
## [1] "Hello World !"
\end{verbatim}
\end{kframe}
\end{knitrout}

  R de ce point de vue est à ranger du coté de javascript, python (hors objet), ...
  


  \subsection{Principe}

  Pire\dots R assure des interconversions automatiques\dots
  
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlkwb{<-} \hlnum{5} \hlopt{+} \hlnum{TRUE}
\hlstd{> }\hlstd{a}
\end{alltt}
\begin{verbatim}
## [1] 6
\end{verbatim}
\end{kframe}
\end{knitrout}



  La subtilité, pourquoi la commande \emph{a} ?
  
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstd{a}
\end{alltt}
\begin{verbatim}
## [1] 6
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{print}\hlstd{(a)}
\end{alltt}
\begin{verbatim}
## [1] 6
\end{verbatim}
\end{kframe}
\end{knitrout}




  Un vecteur se définit comme suit~:
  
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{,}\hlnum{3}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] 1 2 3
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{c}\hlstd{(}\hlstr{"A"}\hlstd{,}\hlstr{"B"}\hlstd{,}\hlstr{"C"}\hlstd{,}\hlstr{"D"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] "A" "B" "C" "D"
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{c}\hlstd{(T,F,T,T,F,T)}
\end{alltt}
\begin{verbatim}
## [1]  TRUE FALSE  TRUE  TRUE FALSE  TRUE
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{c}\hlstd{(T,F,T,T,F,T)} \hlopt{+} \hlnum{0}
\end{alltt}
\begin{verbatim}
## [1] 1 0 1 1 0 1
\end{verbatim}
\end{kframe}
\end{knitrout}



\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{,}\hlnum{3}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] 1 2 3
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{c}\hlstd{(}\hlstr{"A"}\hlstd{,}\hlstr{"B"}\hlstd{,}\hlstr{"C"}\hlstd{,}\hlstr{"D"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] "A" "B" "C" "D"
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{c}\hlstd{(T,F,T,T,F,T)}
\end{alltt}
\begin{verbatim}
## [1]  TRUE FALSE  TRUE  TRUE FALSE  TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}



  \subsection{Les opérateurs}

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlnum{2} \hlopt{+} \hlnum{3} \hlopt{*} \hlnum{2} \hlopt{/} \hlnum{4}
\end{alltt}
\begin{verbatim}
## [1] 3.5
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlstd{T} \hlopt{|} \hlstd{T}
\end{alltt}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}



\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{,}\hlnum{3}\hlstd{)} \hlopt{*} \hlnum{2}
\end{alltt}
\begin{verbatim}
## [1] 2 4 6
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlstd{T} \hlopt{&} \hlkwd{c}\hlstd{(T,F,T)}
\end{alltt}
\begin{verbatim}
## [1]  TRUE FALSE  TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}


  \subsection{Les fonctions déjà développées}

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlkwd{sqrt}\hlstd{(}\hlnum{4}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] 2
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{min}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{2}\hlstd{,}\hlnum{3}\hlstd{,}\hlnum{4}\hlstd{,}\hlnum{20}\hlstd{))}
\end{alltt}
\begin{verbatim}
## [1] 2
\end{verbatim}
\end{kframe}
\end{knitrout}


  \subsection{Les fonctions}

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlkwd{rep}\hlstd{(}\hlnum{2}\hlstd{,}\hlnum{5}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] 2 2 2 2 2
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlkwd{paste}\hlstd{(}\hlstr{"A"}\hlstd{,}\hlstr{"B"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] "A B"
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlnum{1}\hlopt{:}\hlnum{10}
\end{alltt}
\begin{verbatim}
##  [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}
\end{kframe}
\end{knitrout}


\section{Qu'est ce que le langage R~?}

  \subsection{Le type de langage}
  
  R est un langage interprété. C'est-à-dire qu'il va lire le code instructions
  par instructions et exécuté chacune d'elles à chaque fin de ligne.
  
  La fin de ligne peut être au clavier la touche \emph{entrée} ou la fin de ligne
  dans un fichier texte. 
  
  Il existe la possibilité de mettre plusieurs commandes sur la ligne avec le 
  caractère ";". Mais cela est déconseillé.
  

  \subsection{La casse}
  
  Le langage est casse-dépendant ce qui signifie que ~:

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstd{A}\hlkwb{=}\hlnum{5}
\hlstd{> }\hlstd{a}\hlkwb{=}\hlnum{4}
\hlstd{> }\hlstd{A}
\end{alltt}
\begin{verbatim}
## [1] 5
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlstd{a}
\end{alltt}
\begin{verbatim}
## [1] 4
\end{verbatim}
\end{kframe}
\end{knitrout}


  
  Cela est vrai pour les commandes, le nom des variables, \dots mais également
  dans les comparaisons de chaîne de caractère. 
  
  Si on teste l'égalité de deux chaînes on obtient~:

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstr{"A"}\hlopt{==}\hlstr{"a"}
\end{alltt}
\begin{verbatim}
## [1] FALSE
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlstr{"A"}\hlopt{==}\hlstr{"A"}
\end{alltt}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}


\section{L'environnement de travail}

  \subsection{La gestion de la mémoire (1)}
  
  Directement en tapant dans la console ou un programme généralement, les 
  variables créées atterissent dans un "environnement" de base (\emph{GlobalEnv}).
  
  Sauf exception, les variables vont automatiquement être ajoutées à cet 
  environnement. 
  
  Cet environnement comme tous les autres sont en mémoire vive contrairement
  à d'autres logiciels de statistiques.
  
  De plus il n'y a pas de ramasse-miettes. Les variables ne sont supprimées que
  sur la demande de l'utilisateur/programmeur.



    
  La place en mémoire vive est à la fois une force de R et une faiblesse.
  
  Force car la vitesse d'exéuction en mémoire vive permet généralement des 
  performances meilleures que dans d'autres logiciels.
  
  Faiblesse car cela est problématique pour les gros volumes de données.
  



  \subsection{La gestion de la mémoire (2)}
    
  Il existe d'autres environnements que l'environnement de base. Par exemple
  quand on charge un paquet, les variables de ce paquet n'entre pas en conflit
  avec ses propres variables car les variables (et certaines fonctions) du 
  paquet n'atterisse pas dans l'environnement global. 
  
  La création d'environnement est soit automatisé soit volontaire. Automatisé
  par exemple lorsqu'on crée une fonction, les variables de la fonction ne sont
  pas accessibles de l'extérieur.
  
  Volontaire par exemple en appelant la fonction \emph{new.env}.
  

  \subsection{Les opérateurs}
    
  Les opérateurs vont permettre l'assignation mais également les comparaisons
  et les opérations mathématiques.
  
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlkwb{<-} \hlnum{3} \hlcom{# Assignation}
\hlstd{> }\hlstd{a} \hlkwb{=} \hlnum{3} \hlcom{# Assignation (déconseillé)}
\hlstd{> }\hlstd{a} \hlopt{==} \hlnum{3} \hlcom{# Comparaison}
\end{alltt}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlopt{!=} \hlnum{3} \hlcom{# Différent de}
\end{alltt}
\begin{verbatim}
## [1] FALSE
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlopt{+} \hlnum{4}  \hlcom{# somme}
\end{alltt}
\begin{verbatim}
## [1] 7
\end{verbatim}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlopt{|} \hlnum{TRUE} \hlcom{# Ou}
\end{alltt}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}
  
  \dots
  

\section{Opérateurs et variables}

    
  Comme tout langage les règles de précédence entre les arguments sont parfois
  complexes. Les parenthèses permettent de forcer la précédence.
  
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{> }\hlstd{a} \hlkwb{<-} \hlnum{3}\hlopt{+}\hlnum{1}
\hlstd{> }\hlstd{(a} \hlkwb{<-} \hlnum{3}\hlstd{)} \hlopt{+} \hlnum{1}
\end{alltt}
\begin{verbatim}
## [1] 4
\end{verbatim}
\end{kframe}
\end{knitrout}
  

  \subsection{Les variables}
    
  Les variables permettent de stocker les informations. Leur nom ne doit pas 
  commencer par un nombre et ne pas contenir de caractères spéciaux tels que
  les blancs.
  
  En vrai, c'est un peu plus compliqué. Il est possible d'avoir un nom de 
  variable non standard en utilisant guillemets et/ou des guillemets inversés.
  


    
  Vous pouvez utiliser des mots réservés par R. Cela ne soulève pas d'erreurs.
  
  Par contre le mot réservé est "masqué". Il est possible de le faire mais cela
  est déconseillé. Notamment car la procédure de masquage/démasquage peut
  amener à des bugs subtils.






